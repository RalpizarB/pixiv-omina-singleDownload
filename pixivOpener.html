<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>

<body>
    <header class="bg-primary text-white text-center py-3">
        <h1>Welcome to My Website</h1>
    </header>

    <main class="container my-5">
        <p>This is a simple HTML5 boilerplate with Bootstrap.</p>
    </main>
    <textarea id="pixivlinks" class="form-control" rows="5" placeholder="Enter text here"></textarea>
    <button class="btn btn-primary mt-3" onclick="openLinks()">Open Links</button>

    <div class="progress mt-3" style="height: 20px;">
        <div id="progress-bar" class="progress-bar" role="progressbar" style="width: 0%;" aria-valuenow="0"
            aria-valuemin="0" aria-valuemax="100"></div>
    </div>

    <script>
        async function openLinks() {
            const textArea = document.getElementById('pixivlinks');
            const progressBar = document.getElementById('progress-bar');
            const links = textArea.value.split('\n');
            for (const link of links) {
                let modifiedLink = encodeURI(link);
                //adds pixiv-omina://create-download?url= before the link
                modifiedLink = 'pixiv-omina://create-download?url=' + modifiedLink;
                if (modifiedLink.trim()) {
                    let progress = 0;
                    const interval = setInterval(() => {
                        progress += 2; // Increment progress every 100ms
                        progressBar.style.width = `${progress}%`;
                        progressBar.setAttribute('aria-valuenow', progress);
                        if (progress >= 100) {
                            clearInterval(interval);
                        }
                    }, 100);
                    try {
                        win= window.open(modifiedLink.trim(), '_blank');
                        //close window after 1 second
                        setTimeout(() => {
                            win.close();
                        }, 1000);
                        if (!response.ok) {
                            console.error(`Failed to fetch: ${modifiedLink.trim()}`);
                        }
                        await new Promise(resolve => setTimeout(resolve, 5000)); // Wait for 5 seconds
                    } catch (error) {
                        console.error(`Error fetching link: ${modifiedLink.trim()}`, error);
                    }
                }
            }
        }
    </script>

    <footer class="bg-dark text-white text-center py-3">
        <p>&copy; Patasoftware</p>
    </footer>

    <!-- Bootstrap JS Bundle -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

</body>

</html>